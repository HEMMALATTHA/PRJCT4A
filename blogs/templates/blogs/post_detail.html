{% extends "base.html" %}
{% block title %}{{ object.title }}{% endblock %}
{% block content %}
<article>
  <h1>{{ object.title }}</h1>
  <small>by {{ object.author.username }} · {{ object.created_at|date:"Y-m-d H:i" }}</small>
  <div>
    {% for c in object.categories.all %}<span>#{{ c.name }}</span>{% endfor %}
  </div>
  {% if object.image %}<img src="{{ object.image.url }}" style="max-width:500px">{% endif %}
  <p>{{ object.content|linebreaks }}</p>

  {% if user == object.author %}
    <p>
      <a href="{% url 'post-edit' object.slug %}">Edit</a> ·
      <a href="{% url 'post-delete' object.slug %}">Delete</a>
    </p>
  {% endif %}
</article>

<hr>
<h3>Comments</h3>

{% for c in approved_comments %}
  <div style="margin: .5rem 0;">
    <b>{{ c.user.username }}</b> <small>{{ c.created_at|date:"Y-m-d H:i" }}</small>
    <p>{{ c.text|linebreaks }}</p>
  </div>
{% empty %}
  <p>No comments yet.</p>
{% endfor %}

{% if user.is_authenticated %}
<form method="post" action="{% url 'add-comment' object.slug %}">
  {% csrf_token %}
  {{ comment_form.as_p }}
  <button type="submit">Add Comment</button>
</form>
{% else %}
  <p><a href="{% url 'login' %}">Login</a> to comment.</p>
{% endif %}
{% endblock %}
